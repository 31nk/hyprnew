import"./shreddit-slotter-ef4d7aa3.js";import"./faceplate-tabpanel-d2f8372a.js";import"./auth-flow-modal-f4a6088b.js";import"./auth-text-input-cc145c77.js";import"./auth-flow-sso-buttons-cddfef3a.js";import"./shreddit-signup-drawer-3c584d93.js";import{t,E as e,O as s,$ as i,ar as o}from"./shell-9a3ad68e.js";import{_ as a,n,h as r,s as l,A as h,x as c,l as d,f as p}from"./icon-ada4cc58.js";import{S as m}from"./scroll-blocker-7d6d8f9d.js";import{O as f,D as u}from"./constants-9005b662.js";import"./pageable-832f4cce.js";import"./index-67ce581b.js";import"./contextualSignupPrompt-cad3300a.js";import"./faceplate-text-input-b744c6ca.js";import"./live-f7f79f15.js";import"./text-input-8201e088.js";import"./form-common-utils-4dba185c.js";import"./constants-abdf2fa9.js";import"./faceplate-input-6aaf6007.js";import"./input-element-7c19d628.js";import"./light-dom-slot-controller-0b9fcecb.js";import"./auth-flow-controller-7b73c5b3.js";import"./reload-to-logged-in-1a9ad2f8.js";import"./index-b2e05acc.js";import"./load-lazy-script-with-nonce-91b572d7.js";import"./with-recaptcha-9e4e4d99.js";import"./onboarding-680591ff.js";import"./shreddit-overlay-76e650ad.js";let b=o,g=window.location,j=class extends l{constructor(){super(...arguments),this.stepName=null,this.isStandalonePage=!1,this.open=!1,this.history=[],this.events=new e(this),this.scrollBlocker=new m(this),this.findStepElement=t=>this.querySelector(`[slot="${t}"]`),this.requestClose=()=>{this.blocking?this.isStandalonePage&&this.redirectToHome():this.close()},this.redirectToHome=()=>{g.href=location.origin},this.handleEscKey=this.events.define("keydown",(t=>{"Escape"!==t.key||this.blocking||this.close()})),this.onShredditSlot=this.events.define("shreddit-slotter-set-slot-name",(t=>{!t.defaultPrevented&&this.hasStep(t.detail.slotName)&&(t.preventDefault(),this.show(t.detail.slotName))})),this.handleDismissOverlay=this.events.define("dismiss-overlay",this.requestClose),this.handleAccountManagerDismissed=this.events.define("accountmanager-dismissed",this.requestClose),this.deprecated__onFaceplateTrack=this.events.define("faceplate-track",(t=>{const{source:e,action:i,noun:o}=t.detail;e===f&&i===u&&s.has(o)&&this.requestClose()}))}get blocking(){if(this.isStandalonePage)return!0;if(this.open&&this.stepName){return!!this.findStepElement(this.stepName)?.getAttribute("blocking")}return!1}connectedCallback(){super.connectedCallback(),null!==this.stepName&&this.show(this.stepName)}hasStep(t){return!!this.findStepElement(t)}async show(t,e){const s=this.findStepElement(t),o=s?.getAttribute("feature-name");if(!s||!o)return!1;try{await b({root:s,name:o,renderMode:i.Contents,...e,queryParams:{...e?.queryParams,is_standalone:this.isStandalonePage}})}finally{this.open=!0,this.history.push(t),this.stepName=t,this.scrollBlocker.blockPageScrolling()}return!0}back(){if(!this.open)return;this.history.pop();const t=this.history.at(-1);if(!t)return this.requestClose();this.stepName=t}close(){this.open=!1,this.stepName=null,this.history=[],this.scrollBlocker.unblockPageScrolling()}render(){return this.open?c`\n <div class="z-[100] fixed">\n <div \n class="${d(this.isStandalonePage?void 0:"fixed top-0 right-0 bottom-0 left-0 bg-black opacity-50 backdrop-blur-sm")}" \n tabindex="-1" \n @click="${this.requestClose}" \n></div>\n <slot name="${this.stepName}"></slot>\n <slot></slot>\n </div>\n `:h}};j.styles=[t],a([n({attribute:"step-name",type:String,reflect:!0})],j.prototype,"stepName",void 0),a([n({attribute:"is-standalone",type:Boolean})],j.prototype,"isStandalonePage",void 0),a([r()],j.prototype,"open",void 0),j=a([p("auth-flow-manager")],j);
//# sourceMappingURL=auth-overlay-client-js-1bb04739.js.map
