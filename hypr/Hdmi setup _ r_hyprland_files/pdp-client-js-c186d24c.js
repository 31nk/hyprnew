import"./open-interstitial-modal-a40483bd.js";import"./confirm-over-18-6b2300ac.js";import{i as t,_ as e,n as i,h as o,s,x as r,di as n,f as a,dA as d,I as p}from"./icon-ada4cc58.js";import"./faceplate-modal-71a626e6.js";import"./reddit-page-data-c5558b8e.js";import"./shreddit-ad-post-43ddaac4.js";import"./shreddit-comments-page-ad-524e2f4e.js";import{t as c,d as l,gO as m,gP as h,b as f,_ as u}from"./shell-9a3ad68e.js";import"./shreddit-tweet-embed-3f2c7e16.js";import"./faceplate-tabgroup-af375457.js";import"./faceplate-tabpanel-d2f8372a.js";import"./faceplate-shimmer-72ab8c98.js";import"./comment-body-header-bf4d60a7.js";import"./protected-community-modal-trigger-dc2f5600.js";import"./faceplate-dropdown-menu-f53b9d9c.js";import"./faceplate-menu-255c99e7.js";import"./author-flair-event-handler-b131cbb2.js";import"./mod-notes-opener-3abc9833.js";import"./rpl-dialog-trigger-dbb2b7c3.js";import"./guard-community-modal-d122392b.js";import"./chat-channel-recommendations-wrapper-c0668c65.js";import"./rpl-bottom-sheet-818494f2.js";import"./index-b2e05acc.js";import"./shreddit-dynamic-ad-link-5cc9c1d1.js";import"./events-82e64833.js";import"./pixels-2e4ba21b.js";import"./ad-listeners-f91f6374.js";import"./activate-lead-gen-dialog-647ea032.js";import"./content-action-button-d17c08ad.js";import"./shreddit-post-f0deec8f.js";import"./faceplate-date-ea2beded.js";import"./locale-e49f0b05.js";import"./faceplate-number-46bcc98c.js";import"./number-ea0536b9.js";import"./cached-intl-e5b35306.js";import"./index-cc61070e.js";import"./award-controller-29598592.js";import"./award-1b928347.js";import"./awardsTelemetryState-2c2d49a7.js";import"./utils-75a02ea9.js";import"./rpl-tooltip-6ff0c4c3.js";import"./contains-1042b204.js";import"./sleep-a1fd43c3.js";import"./content-tags-241fdcb4.js";import"./postUpdate-2d784242.js";import"./modActions-32f7f996.js";import"./shreddit-post-share-button-fd82e22b.js";import"./list-item-92483316.js";import"./with-share-4fce4a12.js";import"./a-459e5e7b.js";import"./index-6b6f75e3.js";import"./mod-actions-controller-8e16e7f6.js";import"./custom-event-8a5c1c61.js";import"./add-removal-reason-modal-17a54e0c.js";import"./modActions-86176a37.js";import"./keyed-b6c942f1.js";import"./faceplate-form-cfb6343e.js";import"./form-common-utils-4dba185c.js";import"./comment-f86d3e04.js";import"./post-edb43578.js";import"./post-69fe4f77.js";import"./faceplate-input-6aaf6007.js";import"./input-element-7c19d628.js";import"./dropdownButton-4fb00ad8.js";import"./faceplate-textarea-input-ced9fd8a.js";import"./live-f7f79f15.js";import"./text-input-8201e088.js";import"./constants-abdf2fa9.js";import"./remove-highlighted-post-960b6aab.js";import"./utils-147dae00.js";import"./pdp-b6746f62.js";import"./throttle-cde4a556.js";import"./click-card-8df0732f.js";import"./faceplate-hovercard-26cd8885.js";import"./popper-controller-2f3aa0ff.js";import"./makeEventDispatcher-28989282.js";import"./faceplate-tooltip-c7716df6.js";import"./outbound-link-tracking-controller-123a8b1b.js";import"./promote-post-button-12953a09.js";import"./utils-4ebdfa54.js";import"./overflow-menu-actions-24944b9f.js";import"./shreddit-overflow-report-9e45ec2d.js";import"./v2-events-93dbc90c.js";import"./index-db69119e.js";import"./lexical-1c245d48.js";import"./display-theme-7e251d41.js";import"./rtjson-d7db35d6.js";import"./classnameUtils-e77f7123.js";import"./mod-verdict-dcb43309.js";import"./faceplate-carousel-clone-87fd24a1.js";import"./faceplate-pagination-indicator-13acc010.js";import"./TinyGesture-6f7cc1aa.js";import"./index-b5439860.js";import"./faceplate-tablist-ed55a952.js";import"./pageable-832f4cce.js";import"./comment-composer-host-1dfb7e87.js";import"./rte-toolbar-button-emote-c9be9539.js";import"./mention-node-8b3fb963.js";import"./upload-aea4e6c7.js";import"./upload-to-s3-e3788e37.js";import"./postComposerFields-17ca5a70.js";import"./translations-8f2d7cb9.js";import"./faceplate-checkbox-input-1ba9067c.js";import"./checked-input-element-00610e5f.js";import"./automation-rule-triggered-rules-25e055e3.js";import"./filterNullish-14d2de97.js";import"./avatar-62ca4ecf.js";import"./dom-37d48515.js";import"./reputation-recaptcha-f5c28624.js";import"./faceplate-progress-b01dd48c.js";import"./telemetry-event-struct-fef69997.js";import"./commentsPage-9f44e30f.js";import"./mod-notes-aa28f423.js";const j=t=>t.replace(/\n/g,"").replace(/\s+/g," ").trim(),b=({commentId:t,noPrefix:e})=>{let i=t.replace("-comment-rtjson-content","");return e&&(i=i.replace("t1_","")),i},g=({commentId:t,permalink:e,snippetData:i})=>t?`https://publish.reddit.com/embed?url=https://www.reddit.com${e.replace(/\/[^/]+(?=\/$)|\/$/,"")}comment/${b({commentId:t,noPrefix:!0})}?snippet=${i}`:`https://publish.reddit.com/embed?url=https://www.reddit.com${e}?snippet=${i}`,x=["TR","TH","TD","TABLE","TBODY","THEAD"],T=new Set(["H1","P"]);let v=class extends s{constructor(){super(...arguments),this.postId="",this.permalink="",this.topOffset=0,this.leftOffset=0,this.snippetData="",this.isTitleSelected=!1,this.isSelectionOutOfRange=!1,this.isFullTextSelected=!1,this.isComment=!1,this.clearSelection=t=>{if(2!==t.button&&t.target.getAttribute("postid")!==this.postId){const e=((t,e)=>{for(;t;){if(t.id&&(t.id.includes(`${e}-post-rtjson-content`)||t.id.includes("-comment-rtjson-content")))return t;t=t.parentNode}return null})(t.target,this.postId);this.richTextContainer=e,getSelection()?.empty(),this.snippetData="",this.isTitleSelected=!1,this.isSelectionOutOfRange=!1,this.isFullTextSelected=!1}},this.handleEmbedClick=()=>{this.isComment&&this.richTextContainer?.id?open(g({commentId:this.richTextContainer?.id,permalink:this.permalink,snippetData:this.snippetData}),"RedditEmbed"):open(g({permalink:this.permalink,snippetData:this.snippetData}),"RedditEmbed"),this.sendClickTelemetry()},this.isTripleClickHandled=t=>3===t.detail,this.getChildTextNode=t=>{let e;const i=t.childNodes;for(let t=0;t<i.length;t++){const o=i[t];if("#text"!==o.nodeName)continue;0!==j(o.textContent||"").length&&(e=o)}return e},this.getCorrectSelection=t=>{const e=getSelection();if(this.isTripleClickHandled(t)&&e?.anchorNode?.nodeName&&T.has(e?.anchorNode?.nodeName)){const t=this.getChildTextNode(e.anchorNode),i=t?.textContent?.length||0;e.setBaseAndExtent(t,0,t,i)}return e},this.calculateSnippetData=t=>{if(this.shouldShowButton)return void this.clearSelection(t);this.isComment=Boolean(this.richTextContainer?.id&&this.richTextContainer.id.startsWith("t1")),this.snippetData="";const e=this.getCorrectSelection(t),i=j(e?.toString()||"");if(!e||!i?.length)return;const o=this.richTextContainer?j(this.richTextContainer.innerText):"",s=j(this.postTitleElement.innerText);this.richTextContainer&&i===o&&(this.isFullTextSelected=!0);const r=e?.anchorNode;if(r.parentNode?.nodeName&&x.includes(r.parentNode?.nodeName))return;const n=e.getRangeAt(0);r.parentNode===this.postTitleElement&&(this.isTitleSelected=!0),(this.isTitleSelected&&i.length>s.length||this.richTextContainer&&i.length>o.length)&&(this.isSelectionOutOfRange=!0);const a=this.isTitleSelected?this.postTitleElement?.getBoundingClientRect():this.richTextContainer?.getBoundingClientRect(),d=e?.getRangeAt(0).getBoundingClientRect();if(a&&d){if(this.topOffset=d.top+scrollY,this.leftOffset=d.left+d.width/2,this.shadowRoot?.host.style.setProperty("--left-offset",`${this.leftOffset}px`),this.shadowRoot?.host.style.setProperty("--top-offset",this.topOffset-32-4+"px"),this.isTitleSelected||this.isFullTextSelected)return void this.sendViewTelemetry();if(e.rangeCount>0){let t=-1;const e=Array.from((this.isComment?this.richTextContainer?.children[0].children:this.richTextContainer?.children)||[]).filter((t=>"#text"!==t.nodeName));for(let i=0;i<e.length;i++){const o=e[i];if(n.intersectsNode(o)){t=i;break}}if(-1!==t&&i){const o=(({nodeText:t,selectedText:e})=>{if(!t||!e)return-1;const i=t.length,o=e.length,s=[];for(let t=0;t<=i;t++)s[t]=new Array(o+1).fill(0);let r=0,n=0;for(let a=1;a<=i;a++)for(let i=1;i<=o;i++)t[a-1]===e[i-1]&&(s[a][i]=s[a-1][i-1]+1,s[a][i]>r&&(r=s[a][i],n=a-1));const a=t.substring(n-r+1,n+1);return a?t.indexOf(a):-1})({nodeText:j(e[t].innerText),selectedText:i});t>-1&&o>-1&&i.length>0&&(this.snippetData=`${t}_${o}_${i.length}`,this.sendViewTelemetry())}}}},this.getEventDetails=()=>{const t={};return this.isComment&&this.richTextContainer?.id&&(t.comment={id:b({commentId:this.richTextContainer.id})}),t},this.sendViewTelemetry=()=>{const t=this.getEventDetails();this.dispatchEvent(l(m,{details:t}))},this.sendClickTelemetry=()=>{const t=this.getEventDetails();this.dispatchEvent(l(h,{details:t}))}}get shouldShowButton(){return(this.snippetData.length||this.isTitleSelected||this.isFullTextSelected)&&!this.isSelectionOutOfRange}connectedCallback(){super.connectedCallback();const t=document.getElementById(`post-title-${this.postId}`);t&&(this.postTitleElement=t),document.addEventListener("mousedown",this.clearSelection),document.addEventListener("mouseup",this.calculateSnippetData)}disconnectedCallback(){super.disconnectedCallback(),document.removeEventListener("mousedown",this.clearSelection),document.removeEventListener("mouseup",this.calculateSnippetData)}render(){return r`\n ${this.shouldShowButton?r`\n <div class="button-container bg-neutral-content-strong rounded-full shadow-sm flex">\n ${f({appearance:"plainInverted",size:u.Small,attributes:{onclick:this.handleEmbedClick},leadingIcon:n(),children:"Embed"})}\n </div>\n `:""}\n `}};v.styles=[t`.button-container{position:absolute;left:var(--left-offset);top:var(--top-offset);transform:translateX(-50%);z-index:1}`,c],e([i({type:String})],v.prototype,"postId",void 0),e([i({type:String})],v.prototype,"permalink",void 0),e([o()],v.prototype,"topOffset",void 0),e([o()],v.prototype,"leftOffset",void 0),e([o()],v.prototype,"snippetData",void 0),e([o()],v.prototype,"isTitleSelected",void 0),e([o()],v.prototype,"isSelectionOutOfRange",void 0),e([o()],v.prototype,"isFullTextSelected",void 0),e([o()],v.prototype,"isComment",void 0),v=e([a("embed-snippet-share-button")],v);let C=class extends s{constructor(){super(...arguments),this.replaceItselfWithChildren=()=>{this.replaceWith(...this.childNodes)}}render(){return r`<div class="mx-md xs:mx-0">\n <div \n class="items-center justify-between flex flex-row py-sm px-md w-100 bg-neutral-background border-neutral-border rounded-[8px] border-solid border box-border" \n>\n <div>\n ${d({size:p.Medium,attributes:{className:"align-middle mr-2xs"}})}\n <span class="text-neutral-content-weak">\n Posted by a blocked account\n </span>\n </div>\n\n ${f({appearance:"secondary",size:u.Small,attributes:{rel:"nofollow",id:"primary-button",onclick:this.replaceItselfWithChildren},children:"View Post"})}\n </div>\n </div>`}};C.styles=[c],C=e([a("shreddit-blocked-post-content")],C),import("./faceplate-hovercard-26cd8885.js").then((function(t){return t.f})),import("./faceplate-progress-b01dd48c.js"),import("./faceplate-tooltip-c7716df6.js");
//# sourceMappingURL=pdp-client-js-c186d24c.js.map
